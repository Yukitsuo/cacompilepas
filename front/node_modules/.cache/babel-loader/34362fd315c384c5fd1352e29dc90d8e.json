{"ast":null,"code":"var _jsxFileName = \"/usr/src/app/client/src/View/Admin/Admin.tsx\";\nimport React from 'react';\nimport Request from \"../../API/Request\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport { ReactComponent as Loader } from \"@svgr/webpack?-svgo,+titleProp,+ref!../../img/loader.svg\";\nimport Input from \"../General/Input\";\nimport InputArea from \"../General/InputArea\";\nimport DropBox from \"../General/DropBox\";\n\nclass Admin extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isAdmin: '',\n      currentTab: 'presentation',\n      currentLabel: '',\n      currentDescription: '',\n      newLabel: '',\n      newDescription: '',\n      newLogo: null\n    };\n    this.checkIfAdmin = this.checkIfAdmin.bind(this);\n    this.handleLabelChange = this.handleLabelChange.bind(this);\n    this.handleDescriptionChange = this.handleDescriptionChange.bind(this);\n    this.handleFileDrop = this.handleFileDrop.bind(this);\n    this.handleFileChange = this.handleFileChange.bind(this);\n    this.updateLobbby = this.updateLobbby.bind(this);\n    this.updateLabel = this.updateLabel.bind(this);\n  }\n\n  checkIfAdmin(data) {\n    if (undefined === data['message']) {\n      this.setState({\n        isAdmin: 'true'\n      });\n      this.setState({\n        currentLabel: data[0]['label_lobby']\n      });\n      this.setState({\n        currentDescription: data[0]['description']\n      });\n    } else {\n      this.setState({\n        isAdmin: 'false'\n      });\n    }\n  }\n\n  componentDidMount() {\n    new Request('/lobby/consult/' + this.props.location.pathname.split(/\\//)[2], 'POST', 'json', {\n      token: localStorage.getItem('token')\n    }, this.checkIfAdmin);\n  }\n\n  handleLabelChange(event) {\n    this.setState({\n      newLabel: event.target.value\n    });\n    console.log(this.state.newLabel);\n  }\n\n  handleDescriptionChange(event) {\n    this.setState({\n      newDescription: event.target.value\n    });\n    console.log(this.state.newDescription);\n  }\n\n  handleFileDrop(event) {\n    event.preventDefault();\n    this.setState({\n      newLogo: event.dataTransfer.files[0]\n    });\n    console.log(this.state.newLogo);\n  }\n\n  handleFileChange(event) {\n    //event.preventDefault();\n    console.log(event); // @ts-ignore\n\n    this.setState({\n      newLogo: event.target.files[0]\n    });\n    console.log(this.state.newLogo);\n    console.log('hello');\n  }\n\n  updateLabel(data) {\n    if (undefined !== data['message_label']) {\n      this.setState({\n        currentLabel: this.state.newLabel\n      });\n    }\n  }\n\n  updateLobbby(event) {\n    let data;\n\n    if ('' !== this.state.newLabel) {\n      data = {\n        token: localStorage.getItem('token'),\n        label: this.state.newLabel\n      };\n      new Request('/lobby/update/' + this.props.location.pathname.split(/\\//)[2], 'POST', 'json', data, this.updateLabel);\n    }\n\n    if ('' !== this.state.newDescription) {\n      data = {\n        token: localStorage.getItem('token'),\n        description: this.state.newDescription\n      };\n      new Request('/lobby/update/' + this.props.location.pathname.split(/\\//)[2], 'POST', 'json', data, this.updateLabel);\n    }\n\n    if (null !== this.state.newLogo) {\n      data = {\n        token: localStorage.getItem('token'),\n        file: this.state.newLogo\n      };\n      console.log(this.state.newLogo);\n      new Request('/lobby/update/' + this.props.location.pathname.split(/\\//)[2], 'POST', this.state.newLogo.type, data, this.updateLabel);\n    }\n  }\n\n  render() {\n    return React.createElement(Router, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: this.props.path,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, \"Veuillez choisir un lobby\")), React.createElement(Route, {\n      path: this.props.location.pathname,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, () => {\n      if ('true' === this.state.isAdmin) {\n        let tab;\n\n        switch (this.state.currentTab) {\n          case 'presentation':\n            tab = React.createElement(\"div\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 130\n              },\n              __self: this\n            }, React.createElement(\"h2\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 131\n              },\n              __self: this\n            }, \"Informations visibles par les visiteurs\"), React.createElement(Input, {\n              id: 'labelInput',\n              inputType: 'text',\n              placeholder: 'Titre du lobby (n\\'en mets pas un trop long)',\n              className: 'mt-5',\n              onChange: this.handleLabelChange,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 132\n              },\n              __self: this\n            }), React.createElement(InputArea, {\n              id: 'descriptionInput',\n              placeholder: 'Description du lobby\\nRacontes-y ce que tu veux, du moment que ça reste dans le thème de ton lobby',\n              className: 'mt-5',\n              rows: 5,\n              onChange: this.handleDescriptionChange,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 135\n              },\n              __self: this\n            }), React.createElement(DropBox, {\n              id: 'logoInput',\n              className: '',\n              handleFileDrop: this.handleFileDrop,\n              handleFileChange: this.handleFileChange,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 139\n              },\n              __self: this\n            }), React.createElement(SubmitButton, {\n              onClick: this.updateLobbby,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 142\n              },\n              __self: this\n            }));\n            break;\n\n          case 'coursesheets':\n            tab = React.createElement(\"h2\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 148\n              },\n              __self: this\n            }, \"Nouvelle fiche de cours\");\n            break;\n\n          case 'rights':\n            tab = React.createElement(\"h2\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 152\n              },\n              __self: this\n            }, \"Utilisateurs autoris\\xE9s \\xE0 consulter le lobby\");\n            break;\n\n          default:\n            tab = React.createElement(\"h2\", {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 156\n              },\n              __self: this\n            }, \"Informations visibles par les visiteurs\");\n            break;\n        }\n\n        return React.createElement(\"section\", {\n          className: 'content row container-fluid',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: 'row col col-lg-12 col-md-12 col-sm-12 col-xs-12',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: '',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163\n          },\n          __self: this\n        }, this.state.currentLabel))), tab);\n      } else if ('false' === this.state.isAdmin) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        }, \"Vous n'\\xEAtes pas administrateur de ce lobby\"));\n      } else {\n        return React.createElement(\"div\", {\n          className: 'mt-5',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        }, React.createElement(Loader, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        }));\n      }\n    })));\n  }\n\n}\n\nclass SubmitButton extends React.Component {\n  render() {\n    return React.createElement(\"button\", {\n      className: \"btn btn-default btn-transparent mt-0 rounded-1 custom\",\n      onClick: this.props.onClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"Mettre \\xE0 jour le lobby\");\n  }\n\n}\n\nexport default Admin;","map":{"version":3,"sources":["/usr/src/app/client/src/View/Admin/Admin.tsx"],"names":["React","Request","BrowserRouter","Router","Switch","Route","Input","InputArea","DropBox","Admin","Component","constructor","props","state","isAdmin","currentTab","currentLabel","currentDescription","newLabel","newDescription","newLogo","checkIfAdmin","bind","handleLabelChange","handleDescriptionChange","handleFileDrop","handleFileChange","updateLobbby","updateLabel","data","undefined","setState","componentDidMount","location","pathname","split","token","localStorage","getItem","event","target","value","console","log","preventDefault","dataTransfer","files","label","description","file","type","render","path","tab","SubmitButton","onClick"],"mappings":"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","sourcesContent":["import React, {ChangeEvent, ReactNode} from 'react';\nimport Request from \"../../API/Request\";\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n} from \"react-router-dom\";\nimport {ReactComponent as Loader} from \"../../img/loader.svg\";\nimport Input from \"../General/Input\";\nimport InputArea from \"../General/InputArea\";\nimport DropBox from \"../General/DropBox\";\n\ninterface AdminState {\n    isAdmin: string,\n    currentTab: string,\n    currentLabel: string,\n    currentDescription: string,\n    newLabel: string,\n    newDescription: string,\n    newLogo: File | null,\n}\n\nclass Admin extends React.Component<any, AdminState> {\n\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            isAdmin: '',\n            currentTab: 'presentation',\n            currentLabel: '',\n            currentDescription: '',\n            newLabel: '',\n            newDescription: '',\n            newLogo: null,\n        }\n        this.checkIfAdmin = this.checkIfAdmin.bind(this);\n        this.handleLabelChange = this.handleLabelChange.bind(this);\n        this.handleDescriptionChange = this.handleDescriptionChange.bind(this);\n        this.handleFileDrop = this.handleFileDrop.bind(this);\n        this.handleFileChange = this.handleFileChange.bind(this);\n        this.updateLobbby = this.updateLobbby.bind(this);\n        this.updateLabel = this.updateLabel.bind(this);\n    }\n\n    public checkIfAdmin(data: any): void {\n        if (undefined === data['message']) {\n            this.setState({isAdmin: 'true'});\n            this.setState({currentLabel: data[0]['label_lobby']});\n            this.setState({currentDescription: data[0]['description']});\n        } else {\n            this.setState({isAdmin: 'false'});\n        }\n    }\n\n    public componentDidMount(): void {\n        new Request('/lobby/consult/' + this.props.location.pathname.split(/\\//)[2], 'POST', 'json', {token: localStorage.getItem('token')}, this.checkIfAdmin);\n    }\n\n    public handleLabelChange(event: ChangeEvent<HTMLInputElement>): void {\n        this.setState({newLabel: event.target.value});\n        console.log(this.state.newLabel);\n    }\n\n    public handleDescriptionChange(event: ChangeEvent<HTMLTextAreaElement>): void {\n        this.setState({newDescription: event.target.value});\n        console.log(this.state.newDescription);\n    }\n\n    public handleFileDrop(event: React.DragEvent<HTMLDivElement>): void {\n        event.preventDefault();\n        this.setState({newLogo: event.dataTransfer.files[0]});\n        console.log(this.state.newLogo);\n    }\n\n    public handleFileChange(event: ChangeEvent<HTMLInputElement>): void {\n        //event.preventDefault();\n        console.log(event);\n        // @ts-ignore\n        this.setState({newLogo: event.target.files[0]});\n        console.log(this.state.newLogo);\n        console.log('hello');\n    }\n\n    public updateLabel(data: any): void {\n        if (undefined !== data['message_label']) {\n            this.setState({currentLabel: this.state.newLabel});\n        }\n    }\n\n    public updateLobbby(event: React.MouseEvent<HTMLButtonElement, MouseEvent>): void {\n        let data;\n        if ('' !== this.state.newLabel) {\n            data = {\n                token: localStorage.getItem('token'),\n                label : this.state.newLabel,\n            };\n            new Request('/lobby/update/' + this.props.location.pathname.split(/\\//)[2], 'POST', 'json', data, this.updateLabel);\n        }\n        if ('' !== this.state.newDescription) {\n            data = {\n                token: localStorage.getItem('token'),\n                description: this.state.newDescription,\n            };\n            new Request('/lobby/update/' + this.props.location.pathname.split(/\\//)[2], 'POST', 'json', data, this.updateLabel);\n        }\n        if (null !== this.state.newLogo) {\n            data = {\n                token: localStorage.getItem('token'),\n                file: this.state.newLogo,\n            };\n            console.log(this.state.newLogo);\n            new Request('/lobby/update/' + this.props.location.pathname.split(/\\//)[2], 'POST', this.state.newLogo.type, data, this.updateLabel);\n        }\n    }\n\n    public render(): ReactNode {\n        return (\n            <Router>\n                <Switch>\n                    <Route exact path={this.props.path}>\n                        <h3>Veuillez choisir un lobby</h3>\n                    </Route>\n                    <Route path={this.props.location.pathname}>\n                        {() => {\n                            if ('true' === this.state.isAdmin) {\n                                let tab;\n                                switch (this.state.currentTab) {\n                                    case 'presentation':\n                                        tab = (\n                                            <div>\n                                                <h2>Informations visibles par les visiteurs</h2>\n                                                <Input id={'labelInput'} inputType={'text'}\n                                                       placeholder={'Titre du lobby (n\\'en mets pas un trop long)'}\n                                                       className={'mt-5'} onChange={this.handleLabelChange}/>\n                                                <InputArea id={'descriptionInput'}\n                                                           placeholder={'Description du lobby\\nRacontes-y ce que tu veux, du moment que ça reste dans le thème de ton lobby'}\n                                                           className={'mt-5'} rows={5}\n                                                           onChange={this.handleDescriptionChange}/>\n                                                <DropBox id={'logoInput'} className={''}\n                                                         handleFileDrop={this.handleFileDrop}\n                                                         handleFileChange={this.handleFileChange}/>\n                                                <SubmitButton onClick={this.updateLobbby}/>\n                                            </div>\n                                        );\n                                        break;\n\n                                    case 'coursesheets':\n                                        tab = <h2>Nouvelle fiche de cours</h2>;\n                                        break;\n\n                                    case 'rights':\n                                        tab = <h2>Utilisateurs autorisés à consulter le lobby</h2>;\n                                        break;\n\n                                    default:\n                                        tab = <h2>Informations visibles par les visiteurs</h2>\n                                        break;\n                                }\n                                return (\n                                    <section className={'content row container-fluid'}>\n                                        <div className={'row col col-lg-12 col-md-12 col-sm-12 col-xs-12'}>\n                                            <div className={''}>\n                                                <h1>{this.state.currentLabel}</h1>\n                                            </div>\n                                        </div>\n                                        {tab}\n                                    </section>\n                                );\n                            } else if ('false' === this.state.isAdmin) {\n                                return (\n                                    <div>\n                                        <h1>Vous n'êtes pas administrateur de ce lobby</h1>\n                                    </div>\n                                );\n                            } else {\n                                return <div className={'mt-5'}><Loader/></div>\n                            }\n                        }}\n                    </Route>\n                </Switch>\n            </Router>\n        );\n    }\n}\n\nclass SubmitButton extends React.Component<{ onClick: (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void }, {}> {\n    public render() {\n        return (\n            <button className=\"btn btn-default btn-transparent mt-0 rounded-1 custom\"\n                    onClick={this.props.onClick}>Mettre à jour le lobby</button>\n        )\n    }\n}\n\nexport default Admin;"]},"metadata":{},"sourceType":"module"}