{"ast":null,"code":"var _jsxFileName = \"/usr/src/app/client/src/View/Lobby/Lobby.tsx\";\nimport React from 'react';\nimport Divider from '../General/Divider';\nimport Messages from './Messages';\nimport CourseSheets from \"./CourseSheets\";\nimport WriteMessageZone from './WriteMessageZone';\nimport Request from \"../../API/Request\";\nimport '../../css/Lobby.css';\nimport { Switch, Route, BrowserRouter as Router } from \"react-router-dom\";\nimport { ReactComponent as Loader } from \"@svgr/webpack?-svgo,+titleProp,+ref!../../img/loader.svg\";\n\nclass Lobby extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      right: '',\n      courseSheets: [],\n      messages: [],\n      lobbyInformation: []\n    };\n    this.setState = this.setState.bind(this);\n    this.sendMessage = this.sendMessage.bind(this);\n    this.fillCourseSheets = this.fillCourseSheets.bind(this);\n    this.fillDescription = this.fillDescription.bind(this);\n    this.fillMessages = this.fillMessages.bind(this);\n    this.refreshCourseSheets = this.refreshCourseSheets.bind(this);\n    this.refreshDescription = this.refreshDescription.bind(this);\n    this.refreshMessages = this.refreshMessages.bind(this);\n  }\n\n  componentDidMount() {\n    this.refreshCourseSheets();\n    this.refreshDescription();\n    this.refreshMessages();\n  }\n\n  sendMessage(event) {\n    if (13 === event.keyCode) {\n      let content = event.target;\n      new Request('/lobby/addMessage/' + this.props.location.pathname.split(/\\//)[2], this.refreshMessages, 'POST', {\n        content: content.value\n      });\n      content.value = '';\n    }\n  }\n\n  fillDescription(data) {\n    this.setState({\n      lobbyInformation: data[0]\n    });\n  }\n\n  fillMessages(data) {\n    this.setState({\n      messages: data\n    });\n  }\n\n  refreshCourseSheets() {\n    new Request('/lobby/coursesheets/' + this.props.location.pathname.split(/\\//)[2], this.fillCourseSheets);\n  }\n\n  refreshMessages() {\n    new Request('/lobby/messages/' + this.props.location.pathname.split(/\\//)[2], this.fillMessages);\n  }\n\n  refreshDescription() {\n    new Request('/lobby/consult/' + this.props.location.pathname.split(/\\//)[2], this.fillDescription);\n  }\n\n  fillCourseSheets(data) {\n    if (undefined === data['message']) {\n      this.setState({\n        courseSheets: data\n      });\n      this.setState({\n        right: 'true'\n      });\n    } else if (data['message'].includes('right')) {\n      this.setState({\n        right: 'false'\n      });\n    } else {\n      this.setState({\n        right: 'true'\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(Router, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: this.props.path,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"Veuillez choisir un lobby\")), React.createElement(Route, {\n      path: this.props.location.pathname,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, () => {\n      if ('true' === this.state.right) {\n        return React.createElement(\"section\", {\n          className: \"content row container-fluid pr-sm-0\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        }, React.createElement(LobbyTop, {\n          id: this.props.location.pathname.split(/\\//)[2],\n          lobbyInformation: this.state.lobbyInformation,\n          courseSheets: this.state.courseSheets,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }), React.createElement(LobbyBody, {\n          id: this.props.location.pathname.split(/\\//)[2],\n          labelLobby: this.state.lobbyInformation['label_lobby'],\n          courseSheets: this.state.courseSheets,\n          onEnter: this.sendMessage,\n          messages: this.state.messages,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        }));\n      } else if ('false' === this.state.right) {\n        return React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        }, \"Vous n'avez pas les droits n\\xE9cessaires pour acc\\xE9der \\xE0 ce lobby\");\n      } else {\n        return React.createElement(\"div\", {\n          className: 'mt-5',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, React.createElement(Loader, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }));\n      }\n    })));\n  }\n\n}\n\nclass LobbyTop extends React.Component {\n  render() {\n    return React.createElement(\"div\", {\n      className: \"row container-fluid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(LobbyDescription, {\n      id: this.props.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }), React.createElement(LobbySummary, {\n      courseSheets: this.props.courseSheets,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }));\n  }\n\n}\n\nclass LobbySummary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.renderList = this.renderList.bind(this);\n  }\n\n  renderList() {\n    let res = [],\n        i = 0;\n\n    for (let courseSheet of this.props.courseSheets) {\n      res.push(React.createElement(\"li\", {\n        key: i,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: 'mb-0',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, courseSheet['title'])));\n      i++;\n    }\n\n    return res;\n  }\n\n  render() {\n    return React.createElement(\"section\", {\n      className: 'col-lg-12 col-sm-12 pr-sm-0 pr-xs-0' + (0 !== this.props.courseSheets.length ? ' mt-sm-2' : ''),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, 0 !== this.props.courseSheets.length ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      className: \"text-left mb-0 mt-0 ml-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, \"Sommaire\"), React.createElement(\"ul\", {\n      className: \"lobby-summary-list list-unstyled text-left ml-1 mt-3 ml-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, this.renderList()), React.createElement(Divider, {\n      className: 'offset-lg-3 col-lg-6 offset-md-2 col-md-8 col-sm-6 col-xs-6 mt-5 mb-2 ml-4',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    })) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }));\n  }\n\n}\n\nclass LobbyDescription extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lobby: []\n    };\n    this.fillDescription = this.fillDescription.bind(this);\n    this.getLogo = this.getLogo.bind(this);\n    this.fillLogo = this.fillLogo.bind(this);\n    this.refreshDescription = this.refreshDescription.bind(this);\n  }\n\n  componentDidMount() {\n    this.refreshDescription();\n  }\n\n  refreshDescription() {\n    new Request('/lobby/consult/' + this.props.id, this.fillDescription);\n  }\n\n  fillDescription(data) {\n    this.setState({\n      lobby: data[0]\n    }, this.getLogo);\n  }\n\n  getLogo() {\n    new Request('/lobby/getLogo/0', this.fillLogo, 'POST', {\n      idLobby: this.props.id,\n      path: this.state.lobby['logo']\n    }, 'json', 'blob');\n  }\n\n  fillLogo(data) {\n    const img = document.getElementById('lobby-logo' + this.props.id);\n    const blob = new Blob([data], {\n      type: 'image/jpg'\n    });\n    img.src = URL.createObjectURL(blob);\n  }\n\n  render() {\n    return React.createElement(\"section\", {\n      className: \"col-lg-12 col-sm-12 pr-lg-0 pr-md-0 pr-sm-0 pr-xs-0\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'row container-fluid mt-5 p-0',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'col-lg-2 col-md-2 col-sm-3 col-xs-4 text-left pr-lg-0',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      id: 'lobby-logo' + this.props.id,\n      className: 'lobby-logo',\n      alt: 'Lobby logo',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: 'col-lg-10 col-md-10 col-sm-9 col-xs-8 pr-0',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'row',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'col-12 text-left',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, this.state.lobby['label_lobby']))), React.createElement(\"div\", {\n      className: 'row',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'col-12',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"lobby-page-description\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, this.state.lobby['description'])))), React.createElement(Divider, {\n      className: 'col-lg-3 col-md-6 col-sm-6 col-xs-6 mt-5 ml-5 mb-5',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    })));\n  }\n\n}\n\nclass LobbyBody extends React.Component {\n  render() {\n    return React.createElement(\"div\", {\n      className: 'col-lg-12 col-md-12 col-sm-12 col-xs-12',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'col-lg-6 col-md-6 col-sm-12 col-xs-12 container-fluid',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, // @ts-ignore\n    undefined !== this.props.courseSheets[0] ? React.createElement(CourseSheets, {\n      id: this.props.id,\n      courseSheets: this.props.courseSheets,\n      className: 'mt-lg-3 mt-0',\n      activeRemoveButton: false,\n      removableHashtags: false,\n      delete: undefined,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }) : React.createElement(\"div\", {\n      className: 'row mt-5',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'col-12 text-left',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, \"Il n'y a pas de fiches de cours pour l'instant\")))), React.createElement(\"div\", {\n      className: 'col-lg-6 col-md-6 col-sm-12 col-xs-12 container-fluid',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, // @ts-ignore\n    undefined !== this.props.messages[0] ? React.createElement(\"div\", {\n      className: 'row',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, React.createElement(Messages, {\n      id: this.props.id,\n      messages: this.props.messages,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    })) : React.createElement(\"div\", {\n      className: 'row mt-5 mb-5',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'col-12 text-left',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306\n      },\n      __self: this\n    }, \"Il n'y a pas de messages pour l'instant\"))), React.createElement(\"div\", {\n      className: 'row',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310\n      },\n      __self: this\n    }, React.createElement(WriteMessageZone, {\n      labelLobby: this.props.labelLobby,\n      onEnter: this.props.onEnter,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default Lobby;","map":{"version":3,"sources":["/usr/src/app/client/src/View/Lobby/Lobby.tsx"],"names":["React","Divider","Messages","CourseSheets","WriteMessageZone","Request","Switch","Route","BrowserRouter","Router","Lobby","Component","constructor","props","state","right","courseSheets","messages","lobbyInformation","setState","bind","sendMessage","fillCourseSheets","fillDescription","fillMessages","refreshCourseSheets","refreshDescription","refreshMessages","componentDidMount","event","keyCode","content","target","location","pathname","split","value","data","undefined","includes","render","path","LobbyTop","id","LobbySummary","renderList","res","i","courseSheet","push","length","LobbyDescription","lobby","getLogo","fillLogo","idLobby","img","document","getElementById","blob","Blob","type","src","URL","createObjectURL","LobbyBody","labelLobby","onEnter"],"mappings":"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","sourcesContent":["import React, {ReactNode} from 'react';\nimport Divider from '../General/Divider';\nimport Messages from './Messages';\nimport CourseSheets from \"./CourseSheets\";\nimport WriteMessageZone from './WriteMessageZone';\nimport Request from \"../../API/Request\";\nimport '../../css/Lobby.css';\nimport {\n    Switch,\n    Route,\n    BrowserRouter as Router,\n} from \"react-router-dom\";\nimport {ReactComponent as Loader} from \"../../img/loader.svg\";\n\ninterface LobbyState {\n    right: string,\n    courseSheets: [],\n    messages: [],\n    lobbyInformation: any,\n}\n\nclass Lobby extends React.Component<any, LobbyState> {\n\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            right: '',\n            courseSheets: [],\n            messages: [],\n            lobbyInformation: [],\n        }\n        this.setState = this.setState.bind(this);\n        this.sendMessage = this.sendMessage.bind(this);\n        this.fillCourseSheets = this.fillCourseSheets.bind(this);\n        this.fillDescription = this.fillDescription.bind(this);\n        this.fillMessages = this.fillMessages.bind(this);\n        this.refreshCourseSheets = this.refreshCourseSheets.bind(this);\n        this.refreshDescription = this.refreshDescription.bind(this);\n        this.refreshMessages = this.refreshMessages.bind(this);\n    }\n\n    public componentDidMount(): void {\n        this.refreshCourseSheets();\n        this.refreshDescription();\n        this.refreshMessages();\n    }\n\n    public sendMessage(event: React.KeyboardEvent<HTMLDivElement>): void {\n        if (13 === event.keyCode) {\n            let content: any = event.target;\n            new Request(\n                '/lobby/addMessage/' + this.props.location.pathname.split(/\\//)[2],\n                this.refreshMessages,\n                'POST',\n                {content: content.value}\n            );\n            content.value = '';\n        }\n    }\n\n    public fillDescription(data: any): void {\n        this.setState({lobbyInformation: data[0]});\n    }\n\n    public fillMessages(data: any): void {\n        this.setState({messages: data});\n    }\n\n    public refreshCourseSheets(): void {\n        new Request(\n            '/lobby/coursesheets/' +\n            this.props.location.pathname.split(/\\//)[2],\n            this.fillCourseSheets\n        );\n    }\n\n    public refreshMessages(): void {\n        new Request('/lobby/messages/' + this.props.location.pathname.split(/\\//)[2], this.fillMessages);\n    }\n\n    public refreshDescription(): void {\n        new Request('/lobby/consult/' + this.props.location.pathname.split(/\\//)[2], this.fillDescription);\n    }\n\n    public fillCourseSheets(data: any): void {\n        if (undefined === data['message']) {\n            this.setState({courseSheets: data});\n            this.setState({right: 'true'});\n        } else if (data['message'].includes('right')) {\n            this.setState({right: 'false'});\n        } else {\n            this.setState({right: 'true'});\n        }\n    }\n\n    public render(): ReactNode {\n        return (\n            <Router>\n                <Switch>\n                    <Route exact path={this.props.path}>\n                        <h3>Veuillez choisir un lobby</h3>\n                    </Route>\n                    <Route path={this.props.location.pathname}>\n                        {() => {\n                            if ('true' === this.state.right) {\n                                return (\n                                    <section className={\"content row container-fluid pr-sm-0\"}>\n                                        <LobbyTop\n                                            id={this.props.location.pathname.split(/\\//)[2]}\n                                            lobbyInformation={this.state.lobbyInformation}\n                                            courseSheets={this.state.courseSheets}\n                                        />\n                                        <LobbyBody id={this.props.location.pathname.split(/\\//)[2]}\n                                                   labelLobby={this.state.lobbyInformation['label_lobby']}\n                                                   courseSheets={this.state.courseSheets}\n                                                   onEnter={this.sendMessage}\n                                                   messages={this.state.messages}\n                                        />\n                                    </section>\n                                );\n                            } else if ('false' === this.state.right) {\n                                return <h2>Vous n'avez pas les droits nécessaires pour accéder à ce lobby</h2>\n                            } else {\n                                return <div className={'mt-5'}><Loader/></div>\n                            }\n                        }}\n                    </Route>\n                </Switch>\n            </Router>\n        );\n    }\n}\n\nclass LobbyTop extends React.Component<{ id: string, lobbyInformation: any, courseSheets: [] }, {}> {\n\n    public render(): ReactNode {\n        return (\n            <div className=\"row container-fluid\">\n                <LobbyDescription\n                    id={this.props.id}\n                />\n                <LobbySummary courseSheets={this.props.courseSheets}/>\n            </div>\n        )\n    }\n}\n\nclass LobbySummary extends React.Component<{ courseSheets: [] }, {}> {\n    constructor(props: any) {\n        super(props);\n        this.renderList = this.renderList.bind(this);\n    }\n\n    public renderList(): ReactNode {\n        let res = [], i = 0;\n        for (let courseSheet of this.props.courseSheets) {\n            res.push(<li key={i}><p className={'mb-0'}>{courseSheet['title']}</p></li>);\n            i++;\n        }\n        return res;\n    }\n\n    public render(): ReactNode {\n        return (\n            <section className={'col-lg-12 col-sm-12 pr-sm-0 pr-xs-0' + (0 !== this.props.courseSheets.length ? ' mt-sm-2' : '')}>\n                {\n                    0 !== this.props.courseSheets.length ?\n                        <div>\n                            <h2 className=\"text-left mb-0 mt-0 ml-4\">Sommaire</h2>\n                            <ul className=\"lobby-summary-list list-unstyled text-left ml-1 mt-3 ml-4\">\n                                {this.renderList()}\n                            </ul>\n                            <Divider\n                                className={'offset-lg-3 col-lg-6 offset-md-2 col-md-8 col-sm-6 col-xs-6 mt-5 mb-2 ml-4'}\n                            />\n                        </div>\n                        :\n                        <div></div>\n                }\n            </section>\n        );\n    }\n}\n\nclass LobbyDescription extends React.Component<{ id: string }, { lobby: any }> {\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            lobby: [],\n        };\n        this.fillDescription = this.fillDescription.bind(this);\n        this.getLogo = this.getLogo.bind(this);\n        this.fillLogo = this.fillLogo.bind(this);\n        this.refreshDescription = this.refreshDescription.bind(this);\n    }\n\n    public componentDidMount(): void {\n        this.refreshDescription();\n    }\n\n    public refreshDescription(): void {\n        new Request('/lobby/consult/' + this.props.id, this.fillDescription);\n    }\n\n    public fillDescription(data: any): void {\n        this.setState(\n            {lobby: data[0]},\n            this.getLogo);\n    }\n\n    public getLogo(): void {\n        new Request(\n            '/lobby/getLogo/0',\n            this.fillLogo,\n            'POST',\n            {\n                idLobby: this.props.id,\n                path: this.state.lobby['logo'],\n            },\n            'json',\n            'blob',\n        );\n    }\n\n    public fillLogo(data: Blob): void {\n        const img: any = document.getElementById('lobby-logo' + this.props.id);\n        const blob = new Blob([data], {type: 'image/jpg'});\n        img.src = URL.createObjectURL(blob);\n    }\n\n    public render(): ReactNode {\n        return (\n            <section className=\"col-lg-12 col-sm-12 pr-lg-0 pr-md-0 pr-sm-0 pr-xs-0\">\n                <div className={'row container-fluid mt-5 p-0'}>\n                    <div className={'col-lg-2 col-md-2 col-sm-3 col-xs-4 text-left pr-lg-0'}>\n                        <img\n                            id={'lobby-logo' + this.props.id}\n                            className={'lobby-logo'}\n                            alt={'Lobby logo'}\n                        />\n                    </div>\n                    <div className={'col-lg-10 col-md-10 col-sm-9 col-xs-8 pr-0'}>\n                        <div className={'row'}>\n                            <div className={'col-12 text-left'}>\n                                <h1>{this.state.lobby['label_lobby']}</h1>\n                            </div>\n                        </div>\n                        <div className={'row'}>\n                            <div className={'col-12'}>\n                                <p className=\"lobby-page-description\">{this.state.lobby['description']}</p>\n                            </div>\n                        </div>\n                    </div>\n                    <Divider className={'col-lg-3 col-md-6 col-sm-6 col-xs-6 mt-5 ml-5 mb-5'}/>\n                </div>\n            </section>\n        )\n    }\n}\n\ninterface LobbyBodyProps {\n    id: string,\n    labelLobby: string,\n    courseSheets: [],\n    onEnter: (event: React.KeyboardEvent<HTMLDivElement>) => void,\n    messages: any,\n}\n\nclass LobbyBody extends React.Component<LobbyBodyProps, any> {\n    public render(): ReactNode {\n        return (\n            <div className={'col-lg-12 col-md-12 col-sm-12 col-xs-12'}>\n                <div className={'col-lg-6 col-md-6 col-sm-12 col-xs-12 container-fluid'}>\n                    {\n                        // @ts-ignore\n                        undefined !== this.props.courseSheets[0] ?\n                            <CourseSheets\n                                id={this.props.id}\n                                courseSheets={this.props.courseSheets}\n                                className={'mt-lg-3 mt-0'}\n                                activeRemoveButton={false}\n                                removableHashtags={false}\n                                delete={undefined}\n                            />\n                            :\n                            <div className={'row mt-5'}>\n                                <div className={'col-12 text-left'}>\n                                    <p>Il n'y a pas de fiches de cours pour l'instant</p>\n                                </div>\n                            </div>\n                    }\n                </div>\n                <div className={'col-lg-6 col-md-6 col-sm-12 col-xs-12 container-fluid'}>\n                    {\n                        // @ts-ignore\n                        undefined !== this.props.messages[0] ?\n                            <div className={'row'}>\n\n                                <Messages\n                                    id={this.props.id}\n                                    messages={this.props.messages}\n                                /></div>\n                            :\n                            <div className={'row mt-5 mb-5'}>\n                                <div className={'col-12 text-left'}>\n                                    <p>Il n'y a pas de messages pour l'instant</p>\n                                </div>\n                            </div>\n                    }\n                    <div className={'row'}>\n                        <WriteMessageZone\n                            labelLobby={this.props.labelLobby}\n                            onEnter={this.props.onEnter}\n                        />\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Lobby;\n"]},"metadata":{},"sourceType":"module"}